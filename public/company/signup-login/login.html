<!DOCTYPE html>
<htmL>
    <head>
        
        <script src="/__/firebase/6.5.0/firebase-app.js"></script>
        <script src="/__/firebase/6.5.0/firebase-auth.js"></script>
        <script src="/__/firebase/init.js"></script>
        <link href="https://fonts.googleapis.com/css?family=Lato:300" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="login.css">
    </head>

    <script type="text/javascript" src="../../Authentication/authentication.js"></script>
    <script type="text/javascript" src="../../database.js"></script>

    <body>
        <div class="main-container">
            <form>
                <div class="container">
                    <h1 class="login" id="text">Company Login</h1>
                    <label class="email" id="text">Email</label>
                    <input type="text" placeholder="Enter email" name="email" id="email" required>
                    <label class="password" id="text">Password</label>
                    <input type="password" placeholder="Enter password" name="password" id="password" required>
                    <label class="companyID" id="text">Company ID</label>
                    <input type="text" placeholder="Enter Company ID" name="companyID" id="companyID" required>

                    <div class="enter">
                        <button type="button" class="cancelButton">Cancel</button>
                        <input type="button" class="loginButton" value="Login" onclick="companyIDCheck(document.getElementById('companyID').value);">
                    </div>
                    <div class="signup-route">
                        <h3 id="signup">Don't have an account?</h3>
                        <span tabindex="-1" class="signup"><input type="button" class="signup" id="text" onclick="location.href='../signup-login/signup.html';" value="Signup"/></span>
                    </div>
                </div>
            </form>
        </div>
    </body>
    <script type="text/javascript">
        function companyIDCheck(companyID){
            //alert('Email Sent!');
            var docRef = db.collection(CompanyProfile).doc(companyID);
            docRef.get().then(function(doc) {
                //alert('Test Alert!');
                if (doc.exists) {
                    alert('Password Reset Email Sent!');
                    toggleSignIn()
                    console.log("Document data:", doc.data());
                } else {
                    // doc.data() will be undefined in this case
                    alert('Password!');
                    console.log("No such document!");
                }
            }).catch(function(error) {
                console.log("Error getting document:", error);
            });
        }

        function toggleSignIn() {
        if (firebase.auth().currentUser) {
          // [START signout]
          firebase.auth().signOut();
          // [END signout]
        } else {
          var email = document.getElementById('email').value;
          var password = document.getElementById('password').value;
          if (email.length < 4) {
            alert('Please enter an email address.');
            return;
          }
          if (password.length < 4) {
            alert('Please enter a password.');
            return;
          }
          // Sign in with email and pass.
          // [START authwithemail]
          firebase.auth().signInWithEmailAndPassword(email, password).catch(function(error) {

            //redirect to another page
            

            // Handle Errors here.
            var errorCode = error.code;
            var errorMessage = error.message;
            // [START_EXCLUDE]
            if (errorCode === 'auth/wrong-password') {
              alert('Wrong password.');
            } else {
              alert(errorMessage);
            }
            console.log(error);
            document.getElementById('quickstart-sign-in').disabled = false;
            // [END_EXCLUDE]
          });
          // [END authwithemail]
        }
        document.getElementById('quickstart-sign-in').disabled = true;
      }
        
        </script>
</htmL>